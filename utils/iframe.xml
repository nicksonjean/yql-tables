<?xml version="1.0" encoding="UTF-8"?>
<table xmlns="http://query.yahooapis.com/v1/schema/table.xsd">
    <meta>
        <author>Nickson Jeanmerson</author>
        <description>Verifica a operadora de um número telefênico</description>
        <sampleQuery><![CDATA[SELECT * FROM {table} WHERE tel="foo" AND xpath='//div[@class="resultado"]']]></sampleQuery>
        <documentationURL></documentationURL>
    </meta>
    <bindings>
        <select itemPath="" produces="XML">
            <urls>
                <url>{url}</url>
            </urls>
            <inputs>
                <key id="tel" type="xs:string" required="true" paramType="variable"/>
                <key id="xpath" type="xs:string" required="false" paramType="variable"/>
            </inputs>
            <execute>
                <![CDATA[
                    y.include("https://raw.githubusercontent.com/nicksonjean/yql-tables/master/utils/scripts/random_useragent/random_useragent.min.js");
                    var _ua = random_useragent();

                    function crossDomainPost() {
                      // Add the iframe with a unique name
                      var iframe = document.createElement("iframe");
                      var uniqueString = _ua;
                      document.body.appendChild(iframe);
                      iframe.style.display = "none";
                      //iframe.style.width = "640px";
                      //iframe.style.height = "640px";
                      iframe.contentWindow.name = uniqueString;

                      // construct a form with hidden inputs, targeting the iframe
                      var form = document.createElement("form");
                      form.target = uniqueString;
                      form.action = "http://qualoperadora.info/consulta";
                      form.method = "POST";

                      // repeat for each parameter
                      var input = document.createElement("input");
                      input.type = "hidden";
                      input.name = "tel";
                      input.value = tel;
                      form.appendChild(input);

                      document.body.appendChild(form);

                      form.submit();

                    }

                ]]>
            </execute>
        </select>
    </bindings>
</table>
